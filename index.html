
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>#BoykotListesi</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background-color: #f4f4f4; }
    h1, h2 { color: #222; }
    .card, .alt-kutu {
      background: #fff;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    input, textarea, button {
      padding: 10px;
      margin: 5px 0;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 100%;
    }
    button { background-color: #222; color: #fff; cursor: pointer; }
    button:disabled { background-color: #aaa; }
    #sorguSonucu { margin-top: 15px; font-weight: bold; }
    ul { list-style: none; padding: 0; }
    li { margin: 5px 0; background: #eee; padding: 10px; border-radius: 5px; }
  </style>
</head>
<body>
  <h1>#BoykotListesi</h1>

  <!-- Ziyaretçi Yorumları -->
  <div class="alt-kutu">
    <h2>📣 Ziyaretçi Yorumları</h2>
    <form id="yorumFormu">
      <textarea id="yeniYorum" placeholder="Yorumunuzu yazın..." required></textarea>
      <button type="submit" id="yorumBtn">Yorum Gönder</button>
      <div id="yorumDurum" style="margin-top:5px;font-size:14px;"></div>
    </form>
    <ul id="yorumListesi"></ul>
  </div>

  <!-- Marka Sorgulama -->
  <div class="card">
    <h2>🔍 Marka Sorgula</h2>
    <input type="text" id="markaInput" placeholder="Marka adı girin">
    <button onclick="markaSorgula()">Sorgula</button>
    <div id="sorguSonucu"></div>
  </div>

  <script>
    // Ziyaretçi Yorumları
    async function yorumlariGetir() {
      try {
        const response = await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vQmfdjdbPOoOjg4Hm4vHrTW3_wRiM70mjKDO9kX_oDqWY7h4pDgbycb8OF31sG758EKCQKFl4Fj2W2P/pub?gid=2065333465&single=true&output=csv");
        const text = await response.text();
        const satirlar = text.trim().split("\n");
        const liste = document.getElementById("yorumListesi");
        liste.innerHTML = "";
        satirlar.reverse().forEach(yorum => {
          const li = document.createElement("li");
          li.textContent = `“${yorum}”`;
          liste.appendChild(li);
        });
      } catch (e) {
        console.error("Yorumlar alınamadı", e);
      }
    }

    document.getElementById("yorumFormu").addEventListener("submit", async function(e) {
      e.preventDefault();
      const yorum = document.getElementById("yeniYorum").value.trim();
      const btn = document.getElementById("yorumBtn");
      const durum = document.getElementById("yorumDurum");
      if (yorum) {
        btn.disabled = true;
        durum.textContent = "Gönderiliyor...";
        await fetch("https://script.google.com/macros/s/AKfycbxYpopOGoNyDXSurmt5HAjv5e9Hi9ijWAYqowH2i0DafuDaTRa_VTSy7z2Lds6_a3l0/exec", {
          method: "POST",
          body: new URLSearchParams({ yorum })
        });
        document.getElementById("yeniYorum").value = "";
        yorumlariGetir();
        durum.textContent = "✔️ Yorum kaydedildi!";
        setTimeout(() => { durum.textContent = ""; btn.disabled = false; }, 2000);
      }
    });

    // Marka Sorgulama
    async function markaSorgula() {
      const input = document.getElementById("markaInput").value.trim().toLowerCase();
      const sonucDiv = document.getElementById("sorguSonucu");
      sonucDiv.innerHTML = "Sorgulanıyor...";
      try {
        const response = await fetch("boykot.json");
        const data = await response.json();
        const marka = data.boykotListesi.find(m => m.marka.toLowerCase() === input);
        if (marka) {
          sonucDiv.innerHTML = `<p>❌ <strong>${marka.marka}</strong> boykot ediliyor.</p>` + (marka.neden ? `<p>📝 <strong>Neden:</strong> ${marka.neden}</p>` : "");
        } else {
          sonucDiv.innerHTML = `✅ <strong>${input}</strong> şu an boykot listesinde değil.`;
        }
      } catch (error) {
        sonucDiv.innerHTML = "Bir hata oluştu. Lütfen tekrar deneyin.";
      }
    }

    yorumlariGetir();
  </script>
</body>
</html>
